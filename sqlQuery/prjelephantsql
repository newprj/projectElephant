SELECT  'DROP TABLE ' || object_name || ' CASCADE CONSTRAINTS;'
  FROM    user_objects
WHERE   object_type = 'TABLE';

SELECT  'select * from ' || object_name || ';'
  FROM    user_objects
WHERE   object_type = 'TABLE';


select 'drop sequence ' || sequence_name|| ';' from user_sequences;

DROP TABLE BOARD_FILE CASCADE CONSTRAINTS;
DROP TABLE TBL_MESSAGE CASCADE CONSTRAINTS;

DROP TABLE TBL_GROUP CASCADE CONSTRAINTS;
drop sequence SEQ_GNO;

DROP TABLE TBL_USER CASCADE CONSTRAINTS;
drop sequence SEQ_UNO;

DROP TABLE TBL_GROUPUSER CASCADE CONSTRAINTS;
drop sequence SEQ_CID;

DROP TABLE TBL_BOARD CASCADE CONSTRAINTS;
drop sequence SEQ_BNO;

DROP TABLE BOARD_REPLY CASCADE CONSTRAINTS;
drop sequence BOARD_RNO;

DROP TABLE TBL_CALENDAR CASCADE CONSTRAINTS;
drop sequence SEQ_CNO;

commit; 


-- spring database에서 모든 table을 삭제 했습니다
--CREATE DATABASE spring CHARACTER SET utf8 COLLATE utf8_general_ci;

--- create , drop table and sequence

create table tbl_user(
    uno number constraint pk_user primary key,
    user_id varchar2(300) unique,
    password varchar2(300),
    name varchar2(300),
    email varchar2(300));
create sequence seq_uno;
alter table tbl_user add(reg_Date timestamp);
alter table tbl_user add suspension varchar2(50) default 'N' check(suspension in('Y','N'));
alter table tbl_user add suspDate timestamp;
alter table tbl_user add suspContent varchar2(100);
alter table tbl_user add profile varchar(1000);

commit;
create table tbl_group(
    gno number constraint pk_group primary key,
    group_name varchar2(300) unique,
    leader varchar2(300),
    subject varchar2(30),
    description varchar2(2000),
    member_number number,
    regdate timestamp,
    authorized char(1) default 'N' check(authorized in('Y','N')),
    viewCnt number default 0,
    profile varchar2(1000),
    constraint fk_group foreign key(leader) references tbl_user(user_id)
);
create sequence seq_gno;

create table tbl_groupuser(
    cno number primary key,
    authorized varchar2(1) default 'N',
    user_id varchar2(30),
    group_name varchar2(30),
    leader varchar2(2) default 'N',
    constraint fk_g_user foreign key(user_id) references tbl_user(user_id),
    constraint fk_g_group foreign key(group_name) references tbl_group(group_name)
    );
alter table tbl_groupuser add unique(user_id, group_name);
create sequence seq_cno;
desc tbl_groupuser;

create table tbl_board(
    bno number constraint pk_board primary key,
    group_name varchar2(300),
    title varchar2(300),
    content varchar2(2000),
    writer varchar2(300),
    notice char(1) default('N'),
    regdate timestamp default sysdate,
    updatedate timestamp,
    constraint fk_b_user foreign key(writer) references tbl_user(user_id),
    constraint fk_b_group foreign key(group_name) references tbl_group(group_name)
    );  

create sequence seq_bno;

create table board_file(
    uuid varchar2(100) primary key,
    uploadPath varchar2(200),
    fileName varchar2(100),
    fileType char(1) default '1',
    bno number,
    constraint fk_file foreign key(bno) references tbl_board(bno)
    );


create table board_reply(
    rno number primary key,
    bno number,
    reply varchar2(500),
    replyer varchar2(100),
    replydate date default sysdate,
    updatedate timestamp,
    constraint fk_r_bno foreign key(bno) references tbl_board(bno),
    constraint fk_r_user foreign key(replyer) references tbl_user(user_id)
    );   
create sequence board_rno;  

create table tbl_calendar(
    cid number primary key,
    title varchar2(50),
    startDate timestamp,
    endDate timestamp,
    editable varchar2(1) default 'N',
    color varchar2(50),
    description_ varchar2(500),
    location varchar2(100),
    group_ varchar2(500),
    user_ varchar2(50),
    member_ varchar2(50),
    constraint fk_c_group foreign key(group_) references tbl_group(group_name),
    constraint fk_c_user foreign key(user_) references tbl_user(user_id)
    );
create sequence seq_cid;

------------------------------------------------------------------

--- 쿼리 문서 수정 /공유 시 수정한 부분 주석으로 달아주세요 
--- select, update 등 테스트를 위한 쿼리문은 공유 X

----- 어드민기능
--select * from tbl_group;
--update tbl_group set authorized = 'Y' where gno =<40; 
--select * from tbl_groupuser where group_name='맛집8' order by cno;
--update tbl_groupuser set authorized='Y', leader='Y' where cno<=60;
--select * from tbl_groupuser;
--select * from tbl_groupuser;
commit;
-------------------------------------------------------------------------
---select * from user_constraints where table_name='TBL_GROUP'; 
---select * from user_constraints where table_name in ('TBL_BOARD', 'TBL_GROUP');
---alter table tbl_group rename constraint SYS_C007897 to pk_group;
---select table_name, index_name from all_ind_columns where table_name ='tbl_group';

commit;

select * from tbl_group where authorized='Y' order by gno desc;
select * from TBL_GROUP order by gno desc;
select * from TBL_USER;
select * from TBL_GROUPUSER;
select * from BOARD_FILE;
select * from TBL_BOARD;
select * from BOARD_REPLY;
select * from TBL_CALENDAR;
select * from letter_tbl;

--select profile from tbl_group;
--select * from tbl_groupuser where user_id='test5';
--update tbl_groupuser set leader ='Y' where user_id='test39';
--delete from tbl_groupuser where authorized is null;
--select * from tbl_groupuser where user_id='test5';
--update tbl_user set profile='/resources/img/lion.png' where profile is null;

commit;